# wopapa-example

和媳妇儿一起爬虫小练习

爬虫程序重要的分为两个部分：

- 分析目标组成
- 书写爬虫程序

书写程序：

- 结构清晰

> 可以将其规划为一个爬虫的请求模版

其结构体现为：

```python
# pass 未实现函数
import random

import time


class xxxSpidet(object):
    def __int__(self):
        # 定义初始化变量，比如base url, 计数等变量
        pass

    def get_html(self):
        # 获取响应内容，注意使用随机UA
        pass

    def parse_html(self):
        # 使用正则表达式来解析页面,提取数据
        pass

    def save_html(self):
        # 保存数据， 本地文件、数据库等
        pass

    def run(self):
        # 主函数，用来组合整体逻辑
        pass


if __name__ == '__main__':
    # 程序运行
    spider = xxxSpidet()
    spider.run()
    
    
     # 在run 中进行1-2秒休眠，防止反爬虫
    time.sleep(random.randint(1, 2))
```

正则表达式

> - .	匹配除换行符以外的任意字符
> - \w	匹配所有普通字符(数字、字母或下划线)
> - \s	匹配任意的空白符
> - \d	匹配数字
> - \n	匹配一个换行符
> - \t	匹配一个制表符
> - \b	匹配一个单词的结尾
> - ^	匹配字符串的开始位置
> - $	匹配字符串的结尾位置
> - \W	匹配非字母或数字或下划线
> - \D	匹配非数字
> - \S	匹配非空白符
> - a|b	匹配字符 a 或字符 b
> - ()	正则表达式分组所用符号，匹配括号内的表达式，表示一个组。
> - [...]	匹配字符组中的字符
> - [^...]	匹配除了字符组中字符的所有字符


> - *	重复零次或者更多次
> - +	重复一次或者更多次
> - ？	重复0次或者一次
> - {n}	重复n次
> - {n,}	重复n次或者更多次
> - {n,m}	重复n到m次


> - [0123456789]	8	True	在一个字符组里枚举所有字符，字符组里的任意一个字符
> - 和"待匹配字符"相同都视为可以匹配。
> - [0123456789]	a	False	由于字符组中没有 "a" 字符，所以不能匹配。
> - [0-9]	7	True	也可以用-表示范围，[0-9] 就和 [0123456789] 是一个意思。
> - [a-z]	s	True	同样的如果要匹配所有的小写字母，直接用 [a-z] 就可以表示。
> - [A-Z]	B	True	[A-Z] 就表示所有的大写字母。
> - [0-9a-fA-F]	e	True	可以匹配数字，大小写形式的 a～f，用来验证十六进制字符。


> - 正则表达式默认为贪婪匹配，也就是尽可能多的向后匹配字符，比如 {n,m} 表示匹配前面的内容出现 n 到 m 次（n 小于 m），在贪婪模式下，首先以匹配 m 次为目标，而在非贪婪模式是尽可能少的向后匹配内容，也就是说匹配 n 次即可。
> - 贪婪模式转换为非贪婪模式的方法很简单，在元字符后添加“?”即可实现

> - *	*? （左贪婪，右非贪婪）
> - +	+？
> - ？	??
> - {n,m}	{n,m}？

```text
1) re.compile()
该方法用来生成正则表达式对象，其语法格式如下：
regex=re.compile(pattern,flags=0)
参数说明：
pattern：正则表达式对象。
flags：代表功能标志位，扩展正则表达式的匹配。
2) re.findall()
根据正则表达式匹配目标字符串内容。
re.findall(pattern,string,flags=0)
该函数的返回值是匹配到的内容列表，如果正则表达式有子组，则只能获取到子组对应的内容。参数说明如下：
pattern：正则表达式对象。
string：目标字符串
flags：代表功能标志位，扩展正则表达式的匹配。
3) regex.findall()
该函数根据正则表达式对象匹配目标字符串内容。其语法格式如下：
regex.findall(string,pos,endpos)
参数说明：
string 目标字符串。
pos 截取目标字符串的开始匹配位置。
endpos 截取目标字符串的结束匹配位置。
4) re.split()
该函数使用正则表达式匹配内容，切割目标字符串。返回值是切割后的内容列表。参数说明：
re.split(pattern,string,flags = 0)
参数说明：
pattern：正则表达式。
string：目标字符串。
flags：功能标志位,扩展正则表达式的匹配。
5) re.sub
该函数使用一个字符串替换正则表达式匹配到的内容。返回值是替换后的字符串。其语法格式如下：
re.sub(pattern,replace,string,max,flags = 0)
其参数说明：
pattern：正则表达式。
replace：替换的字符串。
string：目标字符串。
max：最多替换几处，默认替换全部，
flags：功能标志位,扩展正则表达式的匹配。
5) re.search()
匹配目标字符串第一个符合的内容，返回值为匹配的对象。语法格式如下：
re.search(pattern,string,flags=0)
参数说明：
pattern：正则表达式
string：目标字符串

flags功能标志位
> 功能标志位的作用是扩展正则表达的匹配功能
A	元字符只能匹配 ASCII码。
I	匹配忽略字母大小写。
S	使得.元字符可以匹配换行符。
M	使 ^ $ 可以匹配每一行的开头和结尾位置。
```